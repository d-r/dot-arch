#!/usr/bin/env nu

use ~/dot/nu/all.nu *

def main [] {}

def "main save-url" [$url] {
    let $marks = (me bookmarks)
    let $key = ($marks | key-of $url) | default ""

    let $key = gum input --placeholder $"Key for ($url)" --value $key

    if ($key | is-not-empty) {
        $marks | upsert $key $url | me save-bookmarks
        notify-send "Bookmark saved"
    }
}

def "main open-bookmark" [] {
    xdg-open (me bookmarks | pick-item)
}

def "main open-bookmark-in-qb" [] {
    (me bookmarks | pick-item) o> /tmp/qb-url
}

def "main open-project" [] {
    let $pro = me projects | pick dir --no-headers
    let $dir = $pro.dir | path expand
    wm spawn $pro.editor $dir
}

def "main run" [] {
    let $app = me apps | select desktop_file name | pick name --no-headers
    wm spawn dex $app.desktop_file
}
